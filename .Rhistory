# hide correlation coefficiens on the diagonal
diag = diag
)
dat$PSS_Score
dat$PSS
options(scipen = 999)
library(ggm)
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$PSS == 'HIGH',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
print(pc.mat)
print(p.mat)
library(corrplot)
#method = "pearson"
sig.level = 0.05
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
number.font = 1
number.cex = 1.75
mar = c(0, 0.5, 2.5, 0)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
colnames(p.mat) <- rownames(p.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
corrplot(pc.mat,
method = "color", col = col(200), number.font = number.font,
mar = mar, number.cex = number.cex,
type = type, order = order,  tl.cex = 2, cl.cex = 2,  addgrid.col = "black",
bg = "white", title = "correlation b/w bioChemical parameters for PSS: HIGH",
addCoef.col = "black", # add correlation coefficient
tl.col = "black", tl.srt = tl.srt, # rotation of text labels
# combine with significance level
p.mat = p.mat, sig.level = sig.level, insig = "blank",
# hide correlation coefficiens on the diagonal
diag = diag
)
# as a default this function outputs a correlation matrix plot
ggstatsplot:: grouped_ggcorrmat(
data = dat2,
cor.vars = c( "PSS_Score", "CSE_Score", "Hb", "MDA_P","MDA_R", "SOD_E", "CAT_P", "PCO_S", "CHOL_S", "CRP_S"),
cor.vars.names =c( "PSS", "CSE", "Hb", "P_MDA","MDA_E", "SOD_E", "CAT_P", "PCO_E", "CHOL_S", "CRP_S"),
grouping.var = PSS,
colors = c("#B2182B", "white", "#4D4D4D"),
title = "Correlalogram for Biochemical Paramters at PSS",
p.adjust.method = "none",
type = "robust",
pch = "cross",
ggcorrplot.args = list(
lab_col = "black",
lab_size = 4,
tl.srt = 90,
pch.col = "black",
pch.cex = 13
),
sig.level = 0.05,
)
options(scipen = 999)
library(ggm)
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$PSS == 'LOW',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
print(pc.mat)
print(p.mat)
library(corrplot)
#method = "pearson"
sig.level = 0.05
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
number.font = 1
number.cex = 1.75
mar = c(0, 0.5, 2.5, 0)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
colnames(p.mat) <- rownames(p.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
corrplot(pc.mat,
method = "color", col = col(200), number.font = number.font,
mar = mar, number.cex = number.cex,
type = type, order = order,  tl.cex = 2, cl.cex = 2,  addgrid.col = "black",
bg = "white", title = "correlation b/w bioChemical parameters for PSS: LOW",
addCoef.col = "black", # add correlation coefficient
tl.col = "black", tl.srt = tl.srt, # rotation of text labels
# combine with significance level
p.mat = p.mat, sig.level = sig.level, insig = "blank",
# hide correlation coefficiens on the diagonal
diag = diag
)
# as a default this function outputs a correlation matrix plot
ggstatsplot:: grouped_ggcorrmat(
data = dat2,
cor.vars = c( "PSS_Score", "CSE_Score", "Hb", "MDA_P","MDA_R", "SOD_E", "CAT_P", "PCO_S", "CHOL_S", "CRP_S"),
cor.vars.names =c( "PSS", "CSE", "Hb", "P_MDA","MDA_E", "SOD_E", "CAT_P", "PCO_E", "CHOL_S", "CRP_S"),
grouping.var = PSS,
colors = c("#B2182B", "white", "#4D4D4D"),
title = "Correlalogram for Biochemical Paramters at PSS",
p.adjust.method = "none",
pch = "cross",
ggcorrplot.args = list(
lab_col = "black",
lab_size = 4,
tl.srt = 90,
pch.col = "black",
pch.cex = 13
),
sig.level = 0.05,
)
dat$PSS_Score
dat$PSS
options(scipen = 999)
library(ggm)
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$PSS == 'MODERATE',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
print(pc.mat)
print(p.mat)
library(corrplot)
#method = "pearson"
sig.level = 0.05
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
number.font = 1
number.cex = 1.75
mar = c(0, 0.5, 2.5, 0)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
colnames(p.mat) <- rownames(p.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
corrplot(pc.mat,
method = "color", col = col(200), number.font = number.font,
mar = mar, number.cex = number.cex,
type = type, order = order,  tl.cex = 2, cl.cex = 2,  addgrid.col = "black",
bg = "white", title = "correlation b/w bioChemical parameters for PSS: MODERATE",
addCoef.col = "black", # add correlation coefficient
tl.col = "black", tl.srt = tl.srt, # rotation of text labels
# combine with significance level
p.mat = p.mat, sig.level = sig.level, insig = "blank",
# hide correlation coefficiens on the diagonal
diag = diag
)
options(scipen = 999)
library(ggm)
dat<-dat[, c("PSS_Score","CSE_Score","Hb", "MDA_R", "MDA_P", "PCO_S" ,"SOD_E","CAT_P","CHOL_S","CRP_S", "Age","BMI")]
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$CSE == 'LOW',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
library(psych)
setwd("~/Desktop/Plots")
files = list.files(pattern = "PARTIAL CORR.csv")
dat= read.table(files, header = TRUE, sep = ",")
dat<-dat[, c("PSS_Score","CSE_Score","Hb", "MDA_R", "MDA_P", "PCO_S" ,"SOD_E","CAT_P","CHOL_S","CRP_S", "Age","BMI", "PSS", "CSE")]
#dat[dat$Parameters == 'Hb',]$Value <- dat[dat$Parameters == 'Hb',]$Value / 100
mat <- partial.r(dat,c(1,2,3,4,5,6,7,8,9,10), cs(Age,BMI))
mat
View(dat)
options(scipen = 999)
library(ggm)
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$CSE == 'LOW',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
print(pc.mat)
print(p.mat)
library(corrplot)
#method = "pearson"
sig.level = 0.05
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
number.font = 1
number.cex = 1.75
mar = c(0, 0.5, 2.5, 0)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
colnames(p.mat) <- rownames(p.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
corrplot(pc.mat,
method = "color", col = col(200), number.font = number.font,
mar = mar, number.cex = number.cex,
type = type, order = order,  tl.cex = 2, cl.cex = 2,  addgrid.col = "black",
bg = "white", title = "correlation b/w bioChemical parameters for CSE: LOW",
addCoef.col = "black", # add correlation coefficient
tl.col = "black", tl.srt = tl.srt, # rotation of text labels
# combine with significance level
p.mat = p.mat, sig.level = sig.level, insig = "blank",
# hide correlation coefficiens on the diagonal
diag = diag
)
options(scipen = 999)
library(ggm)
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$CSE == 'HIGH',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
print(pc.mat)
print(p.mat)
library(corrplot)
#method = "pearson"
sig.level = 0.05
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
number.font = 1
number.cex = 1.75
mar = c(0, 0.5, 2.5, 0)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
colnames(p.mat) <- rownames(p.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
corrplot(pc.mat,
method = "color", col = col(200), number.font = number.font,
mar = mar, number.cex = number.cex,
type = type, order = order,  tl.cex = 2, cl.cex = 2,  addgrid.col = "black",
bg = "white", title = "correlation b/w bioChemical parameters for CSE: HIGH",
addCoef.col = "black", # add correlation coefficient
tl.col = "black", tl.srt = tl.srt, # rotation of text labels
# combine with significance level
p.mat = p.mat, sig.level = sig.level, insig = "blank",
# hide correlation coefficiens on the diagonal
diag = diag
)
options(scipen = 999)
library(ggm)
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$PSS == 'HIGH',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
print(pc.mat)
print(p.mat)
library(corrplot)
#method = "pearson"
sig.level = 0.05
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
number.font = 1
number.cex = 1.75
mar = c(0, 0.5, 2.5, 0)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
colnames(p.mat) <- rownames(p.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
corrplot(pc.mat,
method = "color", col = col(200), number.font = number.font,
mar = mar, number.cex = number.cex,
type = type, order = order,  tl.cex = 2, cl.cex = 2,  addgrid.col = "black",
bg = "white", title = "correlation b/w bioChemical parameters for PSS: HIGH",
addCoef.col = "black", # add correlation coefficient
tl.col = "black", tl.srt = tl.srt, # rotation of text labels
# combine with significance level
p.mat = p.mat, sig.level = sig.level, insig = "blank",
# hide correlation coefficiens on the diagonal
diag = diag
)
options(scipen = 999)
library(ggm)
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$PSS == 'LOW',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
print(pc.mat)
print(p.mat)
library(corrplot)
#method = "pearson"
sig.level = 0.05
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
number.font = 1
number.cex = 1.75
mar = c(0, 0.5, 2.5, 0)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
colnames(p.mat) <- rownames(p.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
corrplot(pc.mat,
method = "color", col = col(200), number.font = number.font,
mar = mar, number.cex = number.cex,
type = type, order = order,  tl.cex = 2, cl.cex = 2,  addgrid.col = "black",
bg = "white", title = "correlation b/w bioChemical parameters for PSS: LOW",
addCoef.col = "black", # add correlation coefficient
tl.col = "black", tl.srt = tl.srt, # rotation of text labels
# combine with significance level
p.mat = p.mat, sig.level = sig.level, insig = "blank",
# hide correlation coefficiens on the diagonal
diag = diag
)
options(scipen = 999)
library(ggm)
dat2<- dat[complete.cases(dat),]
dat3 <- dat2[dat2$PSS == 'MODERATE',]
p.mat <- matrix(NA, 10, 10)
diag(p.mat) <- 0
pc.mat <- matrix(NA, 10, 10)
diag(pc.mat) <- 0
method = 'pearson'
for (i in 1:9) {
for (j in (i + 1):10) {
tmp <- cor.test(dat3[, i], dat3[, j], method = method)
#    pc <- pcor(c(names(dat2)[i], names(dat2)[j], "Age", "BMI"), var(dat2))
#    pv <- pcor.test(pc, 2, nrow(dat2[i]))
#p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
pc.mat[i, j] <- pc.mat[j, i] <- tmp$estimate
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat3[, c(1,2,3,4,5,6,7,8,9,10)])
print(pc.mat)
print(p.mat)
library(corrplot)
#method = "pearson"
sig.level = 0.05
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
order = "original"
diag = FALSE
type = "upper"
tl.srt = 45
number.font = 1
number.cex = 1.75
mar = c(0, 0.5, 2.5, 0)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
colnames(p.mat) <- rownames(p.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
colnames(pc.mat) <- rownames(pc.mat) <- colnames(dat[, c(1,2,3,4,5,6,7,8,9,10)])
corrplot(pc.mat,
method = "color", col = col(200), number.font = number.font,
mar = mar, number.cex = number.cex,
type = type, order = order,  tl.cex = 2, cl.cex = 2,  addgrid.col = "black",
bg = "white", title = "correlation b/w bioChemical parameters for PSS: MODERATE",
addCoef.col = "black", # add correlation coefficient
tl.col = "black", tl.srt = tl.srt, # rotation of text labels
# combine with significance level
p.mat = p.mat, sig.level = sig.level, insig = "blank",
# hide correlation coefficiens on the diagonal
diag = diag
)
library(psych)
setwd("~/Desktop/Plots")
files = list.files(pattern = "PARTIAL CORR.csv")
dat= read.table(files, header = TRUE, sep = ",")
#dat[dat$Parameters == 'Hb',]$Value <- dat[dat$Parameters == 'Hb',]$Value / 100
mat <- partial.r(dat,c(1,2,3,4,5,6,7,8,9,10), cs(Age,BMI))
mat
nnames(dat)
names(dat)
library(ggpubr)
p <- ggstatsplot:: ggscatterstats(
data = dat,
x = PSS_Score,
y = CSE_Score,
xlab = "PSS ",
ylab = "CSE",
title = "Correlation b/w PSS and CSE",
bf.message = FALSE,
)
#p <- stat_cor(method = "pearson", label.x = 2, label.y = 82, )
p
